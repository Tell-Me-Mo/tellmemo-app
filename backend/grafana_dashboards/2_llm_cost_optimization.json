{
  "title": "\ud83d\udcb0 LLM Cost Optimization",
  "tags": [
    "tellmemo",
    "cost",
    "llm"
  ],
  "timezone": "browser",
  "refresh": "1m",
  "panels": [
    {
      "title": "Total LLM Cost (Today)",
      "type": "stat",
      "gridPos": {
        "x": 0,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "description": "Total LLM costs in last 24 hours (USD)",
      "targets": [
        {
          "expr": "sum(increase(business_llm_cost_per_query[24h])) / 100",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      },
      "options": {
        "graphMode": "area",
        "colorMode": "value",
        "orientation": "horizontal",
        "textMode": "value_and_name"
      }
    },
    {
      "title": "Cost per Query (Avg)",
      "type": "stat",
      "gridPos": {
        "x": 6,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "description": "Average cost per query",
      "targets": [
        {
          "expr": "avg(business_llm_cost_per_query) / 100",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      },
      "options": {
        "graphMode": "area",
        "colorMode": "value",
        "orientation": "horizontal",
        "textMode": "value_and_name"
      }
    },
    {
      "title": "Monthly Projected Cost",
      "type": "stat",
      "gridPos": {
        "x": 12,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "description": "Projected monthly LLM costs based on current usage",
      "targets": [
        {
          "expr": "sum(increase(business_llm_cost_monthly[24h])) * 30 / 100",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      },
      "options": {
        "graphMode": "area",
        "colorMode": "value",
        "orientation": "horizontal",
        "textMode": "value_and_name"
      }
    },
    {
      "title": "Cost per User (Avg)",
      "type": "stat",
      "gridPos": {
        "x": 18,
        "y": 0,
        "w": 6,
        "h": 4
      },
      "description": "Average LLM cost per user",
      "targets": [
        {
          "expr": "avg(business_llm_cost_per_user) / 100",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      },
      "options": {
        "graphMode": "area",
        "colorMode": "value",
        "orientation": "horizontal",
        "textMode": "value_and_name"
      }
    },
    {
      "title": "LLM Cost by Provider",
      "type": "timeseries",
      "gridPos": {
        "x": 0,
        "y": 4,
        "w": 12,
        "h": 8
      },
      "description": "Hourly cost breakdown by LLM provider",
      "targets": [
        {
          "expr": "sum(rate(business_llm_cost_by_provider[1h])) by (provider) * 3600 / 100",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      }
    },
    {
      "title": "Cost Distribution by Provider",
      "type": "piechart",
      "gridPos": {
        "x": 12,
        "y": 4,
        "w": 12,
        "h": 8
      },
      "description": "Total cost distribution across providers",
      "targets": [
        {
          "expr": "sum(business_llm_cost_by_provider) by (provider) / 100",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      }
    },
    {
      "title": "LLM Requests per Minute",
      "type": "timeseries",
      "gridPos": {
        "x": 0,
        "y": 12,
        "w": 12,
        "h": 8
      },
      "description": "LLM request rate by provider",
      "targets": [
        {
          "expr": "sum(rate(llm_requests_total[1m])) by (llm_provider) * 60",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "reqpm",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      }
    },
    {
      "title": "Cost vs Query Volume",
      "type": "timeseries",
      "gridPos": {
        "x": 12,
        "y": 12,
        "w": 12,
        "h": 8
      },
      "description": "Cost efficiency: dollars per user question",
      "targets": [
        {
          "expr": "sum(rate(business_llm_cost_per_query[5m])) / sum(rate(business_user_questions_total[5m]))",
          "refId": "A",
          "legendFormat": ""
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "custom": {
            "drawStyle": "line",
            "lineInterpolation": "smooth"
          }
        }
      }
    }
  ],
  "schemaVersion": 36
}